<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2x2 Linear Algebra Calculator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for clean input and output */
        input[type="number"] {
            -moz-appearance: textfield; /* Firefox */
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .matrix-input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 1.25rem;
        }
        .working-step {
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background-color: #f8fafc; /* slate-50 */
            border-radius: 0.375rem;
            font-family: monospace;
            white-space: pre-wrap;
            line-height: 1.5;
        }
        .matrix-display {
            display: inline-flex;
            flex-direction: column;
            border-left: 2px solid black;
            border-right: 2px solid black;
            padding: 0 8px;
            margin: 0 4px;
            font-size: 1.25rem;
        }
        .matrix-row {
            display: flex;
            gap: 12px;
        }
        .matrix-aug {
            border-left: 2px solid black;
            padding-left: 12px;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 md:p-8 font-sans">

    <div class="max-w-7xl mx-auto">
        <header class="text-center py-6 mb-8 bg-white shadow-lg rounded-xl">
            <h1 class="text-3xl md:text-5xl font-extrabold text-indigo-700">Linear Algebra Toolkit (2x2)</h1>
            <p class="text-gray-500 mt-2">Gaussian Elimination, Cramer's Rule, and Vector Operations</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Gaussian Elimination -->
            <div id="gaussian-elimination" class="bg-white p-6 shadow-xl rounded-xl border border-indigo-100">
                <h2 class="text-2xl font-bold text-indigo-600 mb-4 border-b pb-2">1. Gaussian Elimination (2x2)</h2>
                <div class="space-y-4">
                    <div class="flex flex-col space-y-4">
                        <!-- Row 1 Input -->
                        <div class="flex items-center space-x-2">
                            <input type="number" id="ge_a11" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="a11">
                            <span class="text-xl">x +</span>
                            <input type="number" id="ge_a12" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="a12">
                            <span class="text-xl">y =</span>
                            <input type="number" id="ge_b1" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="b1">
                        </div>
                        <!-- Row 2 Input -->
                        <div class="flex items-center space-x-2">
                            <input type="number" id="ge_a21" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="a21">
                            <span class="text-xl">x +</span>
                            <input type="number" id="ge_a22" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="a22">
                            <span class="text-xl">y =</span>
                            <input type="number" id="ge_b2" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="b2">
                        </div>
                    </div>
                    <button onclick="calculateGaussianElimination()" class="w-full bg-indigo-500 text-white py-2 rounded-lg hover:bg-indigo-600 transition duration-150 shadow-md">Solve</button>
                </div>
                <h3 class="text-xl font-semibold mt-6 mb-3 text-indigo-700">Result</h3>
                <div id="ge_result" class="p-3 bg-indigo-50 rounded-lg text-gray-800 font-bold">Enter values and click Solve.</div>
                <h3 class="text-xl font-semibold mt-6 mb-3 text-indigo-700">Working</h3>
                <div id="ge_working" class="border border-gray-200 rounded-lg p-3 h-64 overflow-y-auto"></div>
            </div>

            <!-- Cramer's Rule -->
            <div id="cramers-rule" class="bg-white p-6 shadow-xl rounded-xl border border-indigo-100">
                <h2 class="text-2xl font-bold text-indigo-600 mb-4 border-b pb-2">2. Cramer's Rule (2x2)</h2>
                <div class="space-y-4">
                    <div class="flex flex-col space-y-4">
                        <!-- Row 1 Input (Uses same IDs as Gaussian for simplicity) -->
                        <div class="flex items-center space-x-2">
                            <input type="number" id="cr_a11" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="a11">
                            <span class="text-xl">x +</span>
                            <input type="number" id="cr_a12" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="a12">
                            <span class="text-xl">y =</span>
                            <input type="number" id="cr_b1" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="b1">
                        </div>
                        <!-- Row 2 Input -->
                        <div class="flex items-center space-x-2">
                            <input type="number" id="cr_a21" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="a21">
                            <span class="text-xl">x +</span>
                            <input type="number" id="cr_a22" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="a22">
                            <span class="text-xl">y =</span>
                            <input type="number" id="cr_b2" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="b2">
                        </div>
                    </div>
                    <button onclick="calculateCramersRule()" class="w-full bg-indigo-500 text-white py-2 rounded-lg hover:bg-indigo-600 transition duration-150 shadow-md">Solve</button>
                </div>
                <h3 class="text-xl font-semibold mt-6 mb-3 text-indigo-700">Result</h3>
                <div id="cr_result" class="p-3 bg-indigo-50 rounded-lg text-gray-800 font-bold">Enter values and click Solve.</div>
                <h3 class="text-xl font-semibold mt-6 mb-3 text-indigo-700">Working</h3>
                <div id="cr_working" class="border border-gray-200 rounded-lg p-3 h-64 overflow-y-auto"></div>
            </div>

            <!-- Vector Operations & Graph -->
            <div id="vector-operations" class="bg-white p-6 shadow-xl rounded-xl border border-indigo-100">
                <h2 class="text-2xl font-bold text-indigo-600 mb-4 border-b pb-2">3. Vector Operations (2D)</h2>
                <div class="space-y-4">
                    <!-- Vector 1 Input -->
                    <div class="flex items-center space-x-2">
                        <span class="text-xl font-semibold">V1: (</span>
                        <input type="number" id="v1_x" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="x1">
                        <span class="text-xl">,</span>
                        <input type="number" id="v1_y" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="y1">
                        <span class="text-xl">)</span>
                    </div>
                    <!-- Vector 2 Input -->
                    <div class="flex items-center space-x-2">
                        <span class="text-xl font-semibold">V2: (</span>
                        <input type="number" id="v2_x" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="x2">
                        <span class="text-xl">,</span>
                        <input type="number" id="v2_y" class="matrix-input border rounded-lg focus:ring-indigo-500 focus:border-indigo-500" placeholder="y2">
                        <span class="text-xl">)</span>
                    </div>
                    <button onclick="calculateVectorOperations()" class="w-full bg-indigo-500 text-white py-2 rounded-lg hover:bg-indigo-600 transition duration-150 shadow-md">Calculate & Plot</button>
                </div>
                <h3 class="text-xl font-semibold mt-6 mb-3 text-indigo-700">Results & Plot</h3>
                <div id="vo_result" class="p-3 bg-indigo-50 rounded-lg text-gray-800 font-bold mb-4">Enter values and click Calculate & Plot.</div>
                <canvas id="vectorCanvas" width="300" height="300" class="border border-gray-300 rounded-lg mx-auto bg-white"></canvas>
                <h3 class="text-xl font-semibold mt-6 mb-3 text-indigo-700">Working</h3>
                <div id="vo_working" class="border border-gray-200 rounded-lg p-3 h-32 overflow-y-auto"></div>
            </div>

        </main>
    </div>

    <script>
        // Utility function to safely get input values as floats
        function getFloatValue(id) {
            const el = document.getElementById(id);
            // If the field is empty, it returns 0, which is handled correctly by the calculations.
            return parseFloat(el.value || 0);
        }

        // Utility to format number to 2 decimal places
        function format(num) {
            if (Math.abs(num - Math.round(num)) < 0.000001) {
                return num.toFixed(0); // If effectively integer, show no decimals
            }
            return num.toFixed(2);
        }

        // --- Core Functions for Gaussian Elimination ---
        function calculateGaussianElimination() {
            const a11 = getFloatValue('ge_a11');
            const a12 = getFloatValue('ge_a12');
            const b1 = getFloatValue('ge_b1');
            const a21 = getFloatValue('ge_a21');
            const a22 = getFloatValue('ge_a22');
            const b2 = getFloatValue('ge_b2');

            const resultDiv = document.getElementById('ge_result');
            const workingDiv = document.getElementById('ge_working');
            workingDiv.innerHTML = `<div class="font-bold text-gray-600">Starting System:</div>`;

            // Display initial augmented matrix
            const initialMatrix = [
                [a11, a12, b1],
                [a21, a22, b2]
            ];
            workingDiv.innerHTML += formatMatrix(initialMatrix) + '<br>';

            // 1. Check for singular matrix (determinant is zero)
            const det = a11 * a22 - a12 * a21;
            if (Math.abs(det) < 0.000001) {
                resultDiv.className = 'p-3 bg-red-100 rounded-lg text-red-800 font-bold';
                resultDiv.innerHTML = 'System has NO UNIQUE solution (Determinant is zero).';
                workingDiv.innerHTML += '<div class="working-step text-red-700">Determinant = 0. No unique solution exists (infinite solutions or no solution).</div>';
                return;
            }

            let M = [
                [a11, a12, b1],
                [a21, a22, b2]
            ];

            // 2. Normalize R1 (if a11 != 1)
            if (a11 !== 1) {
                const factor = a11;
                M[0][0] /= factor;
                M[0][1] /= factor;
                M[0][2] /= factor;
                workingDiv.innerHTML += `<div class="working-step">Step 1: Normalize R1 (R1 = R1 / ${format(factor)}):</div>`;
                workingDiv.innerHTML += formatMatrix(M) + '<br>';
            }

            // Recalculate factor in case of division by zero (already caught by det check, but good practice)
            if (Math.abs(M[0][0]) < 0.000001) {
                // If the first element is zero after swapping, it means the system is singular.
                // Since det check is done, this should only happen if inputs are all zeros, but let's keep it simple.
                return;
            }

            // 3. Eliminate R2, first element (Get a21 to 0)
            const factor21 = M[1][0] / M[0][0];
            M[1][0] = M[1][0] - factor21 * M[0][0]; // Should be 0
            M[1][1] = M[1][1] - factor21 * M[0][1];
            M[1][2] = M[1][2] - factor21 * M[0][2];

            workingDiv.innerHTML += `<div class="working-step">Step 2: Eliminate x from R2 (R2 = R2 - ${format(factor21)} * R1):</div>`;
            workingDiv.innerHTML += formatMatrix(M) + '<br>';

            // 4. Back-Substitution: Solve for y
            const new_a22 = M[1][1];
            const new_b2 = M[1][2];

            const y = new_b2 / new_a22;
            workingDiv.innerHTML += `<div class="working-step">Step 3: Solve for y from R2: <br> ${format(new_a22)}y = ${format(new_b2)} <br> y = ${format(new_b2)} / ${format(new_a22)} = ${format(y)}</div>`;

            // 5. Back-Substitution: Solve for x
            const old_a12 = M[0][1];
            const old_b1 = M[0][2];
            const x = (old_b1 - old_a12 * y) / M[0][0];

            workingDiv.innerHTML += `<div class="working-step">Step 4: Substitute y back into R1 ($M_{11}x + M_{12}y = M_{13}$): <br> ${format(M[0][0])}x + ${format(old_a12)}(${format(y)}) = ${format(old_b1)} <br> ${format(M[0][0])}x = ${format(old_b1)} - ${format(old_a12 * y)} <br> x = ${format(x)}</div>`;

            // Final Result
            resultDiv.className = 'p-3 bg-indigo-500 text-white rounded-lg text-xl font-bold';
            resultDiv.innerHTML = `Solution: x = ${format(x)}, y = ${format(y)}`;
        }

        // Helper to format a 2x3 augmented matrix for display
        function formatMatrix(matrix) {
            const displayMatrix = matrix.map(row =>
                `<div class="matrix-row">${row.slice(0, 2).map(val => `<span>${format(val)}</span>`).join('')}<span class="matrix-aug">${format(row[2])}</span></div>`
            ).join('');

            return `<div class="matrix-display">${displayMatrix}</div>`;
        }


        // --- Core Functions for Cramer's Rule ---
        function calculateCramersRule() {
            const a11 = getFloatValue('cr_a11');
            const a12 = getFloatValue('cr_a12');
            const b1 = getFloatValue('cr_b1');
            const a21 = getFloatValue('cr_a21');
            const a22 = getFloatValue('cr_a22');
            const b2 = getFloatValue('cr_b2');

            const resultDiv = document.getElementById('cr_result');
            const workingDiv = document.getElementById('cr_working');
            workingDiv.innerHTML = `<div class="font-bold text-gray-600">System of Equations:</div>`;
            workingDiv.innerHTML += `<div class="working-step">${format(a11)}x + ${format(a12)}y = ${format(b1)} <br> ${format(a21)}x + ${format(a22)}y = ${format(b2)}</div>`;

            // 1. Calculate Determinant D
            const D = a11 * a22 - a12 * a21;
            workingDiv.innerHTML += `<div class="working-step">Step 1: Calculate Determinant D (Coefficient Matrix): <br> D = (${format(a11)} * ${format(a22)}) - (${format(a12)} * ${format(a21)}) <br> D = ${format(a11 * a22)} - ${format(a12 * a21)} = ${format(D)}</div>`;

            if (Math.abs(D) < 0.000001) {
                resultDiv.className = 'p-3 bg-red-100 rounded-lg text-red-800 font-bold';
                resultDiv.innerHTML = 'System has NO UNIQUE solution (Determinant D is zero).';
                workingDiv.innerHTML += '<div class="working-step text-red-700">Since D = 0, no unique solution exists (infinite solutions or no solution).</div>';
                return;
            }

            // 2. Calculate Determinant Dx
            const Dx = b1 * a22 - a12 * b2;
            workingDiv.innerHTML += `<div class="working-step">Step 2: Calculate Determinant Dₓ (Replace x-column with B): <br> Dₓ = (${format(b1)} * ${format(a22)}) - (${format(a12)} * ${format(b2)}) <br> Dₓ = ${format(b1 * a22)} - ${format(a12 * b2)} = ${format(Dx)}</div>`;

            // 3. Calculate Determinant Dy
            const Dy = a11 * b2 - b1 * a21;
            workingDiv.innerHTML += `<div class="working-step">Step 3: Calculate Determinant Dᵧ (Replace y-column with B): <br> Dᵧ = (${format(a11)} * ${format(b2)}) - (${format(b1)} * ${format(a21)}) <br> Dᵧ = ${format(a11 * b2)} - ${format(b1 * a21)} = ${format(Dy)}</div>`;

            // 4. Calculate x and y
            const x = Dx / D;
            const y = Dy / D;

            workingDiv.innerHTML += `<div class="working-step">Step 4: Solve for x and y: <br> x = Dₓ / D = ${format(Dx)} / ${format(D)} = ${format(x)} <br> y = Dᵧ / D = ${format(Dy)} / ${format(D)} = ${format(y)}</div>`;

            // Final Result
            resultDiv.className = 'p-3 bg-indigo-500 text-white rounded-lg text-xl font-bold';
            resultDiv.innerHTML = `Solution: x = ${format(x)}, y = ${format(y)}`;
        }


        // --- Core Functions for Vector Operations ---
        function calculateVectorOperations() {
            const v1_x = getFloatValue('v1_x');
            const v1_y = getFloatValue('v1_y');
            const v2_x = getFloatValue('v2_x');
            const v2_y = getFloatValue('v2_y');

            // 1. Calculations
            const V1 = [v1_x, v1_y];
            const V2 = [v2_x, v2_y];

            const V_add = [v1_x + v2_x, v1_y + v2_y];
            const V_sub = [v1_x - v2_x, v1_y - v2_y];
            const dot_product = v1_x * v2_x + v1_y * v2_y;
            const mag_v1 = Math.sqrt(v1_x * v1_x + v1_y * v1_y);

            // 2. Working Output
            const workingDiv = document.getElementById('vo_working');
            workingDiv.innerHTML = `<div class="font-bold text-gray-600">Input Vectors: V1 = (${format(v1_x)}, ${format(v1_y)}), V2 = (${format(v2_x)}, ${format(v2_y)})</div>`;

            workingDiv.innerHTML += `<div class="working-step">Addition (V1 + V2): <br> (${format(v1_x)} + ${format(v2_x)}, ${format(v1_y)} + ${format(v2_y)}) = (${format(V_add[0])}, ${format(V_add[1])})</div>`;
            workingDiv.innerHTML += `<div class="working-step">Subtraction (V1 - V2): <br> (${format(v1_x)} - ${format(v2_x)}, ${format(v1_y)} - ${format(v2_y)}) = (${format(V_sub[0])}, ${format(V_sub[1])})</div>`;
            workingDiv.innerHTML += `<div class="working-step">Dot Product (V1 • V2): <br> (${format(v1_x)}*${format(v2_x)}) + (${format(v1_y)}*${format(v2_y)}) = ${format(dot_product)}</div>`;
            workingDiv.innerHTML += `<div class="working-step">Magnitude of V1 (|V1|): <br> √(${format(v1_x)}² + ${format(v1_y)}²) = ${format(mag_v1)}</div>`;

            // 3. Result Output
            const resultDiv = document.getElementById('vo_result');
            resultDiv.className = 'p-3 bg-indigo-500 text-white rounded-lg font-bold';
            resultDiv.innerHTML = `V1 + V2 = (${format(V_add[0])}, ${format(V_add[1])}) | V1 • V2 = ${format(dot_product)}`;

            // 4. Graphing
            drawVectors(V1, V2, V_add);
        }

        // --- Canvas Drawing Function ---
        function drawVectors(V1, V2, V_result) {
            const canvas = document.getElementById('vectorCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;

            // Find the maximum absolute value to determine a safe, dynamic scale
            const maxVal = Math.max(
                Math.abs(V1[0]), Math.abs(V1[1]),
                Math.abs(V2[0]), Math.abs(V2[1]),
                Math.abs(V_result[0]), Math.abs(V_result[1]),
                5 // Ensure a minimum view area
            );
            // Calculate dynamic scale, ensuring it doesn't try to divide by zero or scale too aggressively
            const dynamicScale = Math.max(1, Math.floor(Math.min(centerX / maxVal, centerY / maxVal)) - 2);

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Draw Grid
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 0.5;
            for (let i = 0; i <= width / dynamicScale; i++) {
                ctx.beginPath();
                ctx.moveTo(i * dynamicScale, 0);
                ctx.lineTo(i * dynamicScale, height);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(0, i * dynamicScale);
                ctx.lineTo(width, i * dynamicScale);
                ctx.stroke();
            }

            // Draw Axes
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(centerX, 0); ctx.lineTo(centerX, height); // Y-axis
            ctx.moveTo(0, centerY); ctx.lineTo(width, centerY); // X-axis
            ctx.stroke();

            // Function to convert vector coordinates to canvas coordinates
            function toCanvasX(x) { return centerX + x * dynamicScale; }
            function toCanvasY(y) { return centerY - y * dynamicScale; }

            // Function to draw an arrow (vector)
            function drawArrow(v, color, label) {
                const startX = centerX;
                const startY = centerY;
                const endX = toCanvasX(v[0]);
                const endY = toCanvasY(v[1]);

                ctx.strokeStyle = color;
                ctx.fillStyle = color;
                ctx.lineWidth = 3;

                // Draw line
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(endX, endY);
                ctx.stroke();

                // Draw Arrowhead (simple triangle)
                const angle = Math.atan2(endY - startY, endX - startX);
                const headLen = 10;
                ctx.beginPath();
                ctx.moveTo(endX, endY);
                ctx.lineTo(endX - headLen * Math.cos(angle - Math.PI / 6), endY - headLen * Math.sin(angle - Math.PI / 6));
                ctx.lineTo(endX - headLen * Math.cos(angle + Math.PI / 6), endY - headLen * Math.sin(angle + Math.PI / 6));
                ctx.closePath();
                ctx.fill();

                // Draw Label
                ctx.fillStyle = color;
                ctx.font = '14px sans-serif';
                ctx.fillText(label, endX + 5, endY - 5);
            }

            // Draw vectors
            drawArrow(V1, '#3b82f6', `V1 (${format(V1[0])}, ${format(V1[1])})`); // Blue
            drawArrow(V2, '#ef4444', `V2 (${format(V2[0])}, ${format(V2[1])})`); // Red
            drawArrow(V_result, '#10b981', `V1 + V2 (${format(V_result[0])}, ${format(V_result[1])})`); // Green

            // Draw the Parallelogram for V_add (optional, but shows visual addition)
            ctx.strokeStyle = '#10b98180';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);

            // Draw V1 translated by V2
            ctx.beginPath();
            ctx.moveTo(toCanvasX(V2[0]), toCanvasY(V2[1]));
            ctx.lineTo(toCanvasX(V_result[0]), toCanvasY(V_result[1]));
            ctx.stroke();

            // Draw V2 translated by V1
            ctx.beginPath();
            ctx.moveTo(toCanvasX(V1[0]), toCanvasY(V1[1]));
            ctx.lineTo(toCanvasX(V_result[0]), toCanvasY(V_result[1]));
            ctx.stroke();

            ctx.setLineDash([]); // Reset line dash
        }

        // Initialize with default calculations on load - removed initial calls to ensure clean slate
        window.onload = function() {
            // Placeholder: Optionally, you could call drawVectors([0,0], [0,0], [0,0]) here to draw an empty grid.
        };

    </script>
</body>
</html>
